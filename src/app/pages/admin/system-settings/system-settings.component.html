<div class="grid">
    <div class="col-12">
        <div class="card">
            <div class="flex justify-content-between align-items-center mb-4">
                <h5 class="m-0">
                    <i class="pi pi-cog mr-2"></i>
                    Configuraciones del Sistema
                </h5>
                <div class="flex gap-2">
                    <button pButton type="button" label="Restablecer" icon="pi pi-refresh" 
                            class="p-button-outlined p-button-secondary" 
                            (click)="resetToDefaults()" 
                            [disabled]="loading || saving">
                    </button>
                    <button pButton type="button" label="Guardar" icon="pi pi-save" 
                            (click)="saveSettings()" 
                            [loading]="saving" 
                            [disabled]="loading">
                    </button>
                </div>
            </div>

            <div *ngIf="loading" class="flex justify-content-center p-4">
                <p-progressSpinner></p-progressSpinner>
            </div>

            <form [formGroup]="settingsForm" *ngIf="!loading">
                <!-- Configuración General -->
                <div class="formgrid grid">
                    <div class="field col-12 md:col-6">
                        <label for="platform_name" class="block text-900 font-medium mb-2">
                            Nombre de la Plataforma *
                        </label>
                        <input pInputText id="platform_name" formControlName="platform_name" 
                               placeholder="BarberSaaS" class="w-full" />
                        <small class="p-error block mt-1" *ngIf="getFieldError('platform_name')">
                            {{ getFieldError('platform_name') }}
                        </small>
                    </div>

                    <div class="field col-12 md:col-6">
                        <label for="support_email" class="block text-900 font-medium mb-2">
                            Email de Soporte *
                        </label>
                        <input pInputText id="support_email" formControlName="support_email" 
                               placeholder="soporte@barbersaas.com" class="w-full" />
                        <small class="p-error block mt-1" *ngIf="getFieldError('support_email')">
                            {{ getFieldError('support_email') }}
                        </small>
                    </div>
                </div>

                <p-divider></p-divider>

                <!-- Configuración de Tenants -->
                <h6 class="text-900 font-semibold mb-3">
                    <i class="pi pi-building mr-2"></i>
                    Configuración de Clientes
                </h6>

                <div class="formgrid grid">
                    <div class="field col-12 md:col-4">
                        <label for="max_tenants" class="block text-900 font-medium mb-2">
                            Máximo de Clientes *
                        </label>
                        <p-inputNumber id="max_tenants" formControlName="max_tenants" 
                                       [min]="1" [max]="10000" class="w-full">
                        </p-inputNumber>
                        <small class="p-error block mt-1" *ngIf="getFieldError('max_tenants')">
                            {{ getFieldError('max_tenants') }}
                        </small>
                    </div>

                    <div class="field col-12 md:col-4">
                        <label for="trial_days" class="block text-900 font-medium mb-2">
                            Días de Prueba *
                        </label>
                        <p-inputNumber id="trial_days" formControlName="trial_days" 
                                       [min]="0" [max]="365" suffix=" días" class="w-full">
                        </p-inputNumber>
                        <small class="p-error block mt-1" *ngIf="getFieldError('trial_days')">
                            {{ getFieldError('trial_days') }}
                        </small>
                    </div>

                    <div class="field col-12 md:col-4">
                        <label for="default_currency" class="block text-900 font-medium mb-2">
                            Moneda por Defecto *
                        </label>
                        <p-dropdown id="default_currency" [options]="currencyOptions" 
                                    formControlName="default_currency" optionLabel="label" 
                                    optionValue="value" placeholder="Seleccionar moneda" 
                                    class="w-full">
                        </p-dropdown>
                    </div>
                </div>

                <p-divider></p-divider>

                <!-- Configuración del Sistema -->
                <h6 class="text-900 font-semibold mb-3">
                    <i class="pi pi-server mr-2"></i>
                    Configuración del Sistema
                </h6>

                <div class="formgrid grid">
                    <div class="field col-12 md:col-6">
                        <label for="backup_frequency" class="block text-900 font-medium mb-2">
                            Frecuencia de Respaldo *
                        </label>
                        <p-dropdown id="backup_frequency" [options]="backupFrequencyOptions" 
                                    formControlName="backup_frequency" optionLabel="label" 
                                    optionValue="value" placeholder="Seleccionar frecuencia" 
                                    class="w-full">
                        </p-dropdown>
                    </div>
                </div>

                <!-- Preferencias del Sistema -->
                <div class="mt-4">
                    <h6 class="text-900 font-semibold mb-3">
                        <i class="pi pi-sliders-h mr-2"></i>
                        Preferencias del Sistema
                    </h6>

                    <div class="formgrid grid">
                        <div class="field-checkbox col-12 md:col-4">
                            <p-checkbox formControlName="maintenance_mode" [binary]="true" 
                                        inputId="maintenance"></p-checkbox>
                            <label for="maintenance" class="ml-2 text-900">
                                Modo Mantenimiento
                            </label>
                        </div>

                        <div class="field-checkbox col-12 md:col-4">
                            <p-checkbox formControlName="email_notifications" [binary]="true" 
                                        inputId="email_notifications"></p-checkbox>
                            <label for="email_notifications" class="ml-2 text-900">
                                Notificaciones por Email
                            </label>
                        </div>

                        <div class="field-checkbox col-12 md:col-4">
                            <p-checkbox formControlName="auto_suspend_expired" [binary]="true" 
                                        inputId="auto_suspend"></p-checkbox>
                            <label for="auto_suspend" class="ml-2 text-900">
                                Suspender Automáticamente Vencidos
                            </label>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<p-confirmDialog></p-confirmDialog>
<p-toast></p-toast>